% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get.plot.R
\name{get.plot}
\alias{get.plot}
\title{Generate statistical plots with tests, post-hoc results, and compact letter displays}
\usage{
get.plot(
  data,
  response,
  factor,
  method = NULL,
  adjust = NULL,
  var.method = NULL,
  var.adjust = NULL,
  flip = FALSE,
  filter.na = FALSE,
  group.order = NULL,
  print.test = FALSE,
  export.test = FALSE,
  show.test = FALSE,
  show.ph = FALSE,
  show.letters = FALSE,
  show.brackets = FALSE,
  plot.type = "boxplot",
  fill = FALSE,
  fill.box = "white",
  box.alpha = 1,
  fill.point = "white",
  point.alpha = 1,
  fill.mean = "black",
  mean.alpha = 1,
  log = FALSE,
  group.label = NULL,
  show.legend = FALSE,
  point.shape = 21,
  mean.shape = 21,
  point.size = 2.5,
  mean.size = 2.5,
  jitter.width = 0.2,
  error.width = 0.2,
  error.alpha = 1,
  axis.title.x = NULL,
  axis.title.y = NULL,
  axis.breaks.size = 12,
  axis.title.size = 12,
  axis.title.face = "plain",
  label.angle = 0,
  label.face = "plain",
  letters.face = "plain",
  letters.size = 5,
  text.family = "sans",
  theme.style = "classic",
  padding = 0.2,
  grid = FALSE,
  grid.axis = FALSE,
  ncol,
  nrow,
  grid.axis.x = factor,
  grid.axis.y = "Concentration",
  x.title.shift = 0.02,
  var.size = 18,
  var.face = "bold",
  save.plot = FALSE,
  by.var = FALSE,
  plot.height = 5,
  plot.width = 5,
  plot.name = "plot_{var}.png",
  save.grid = FALSE,
  grid.name = "grid.png",
  grid.height = 8,
  grid.width = 7
)
}
\arguments{
\item{data}{A data.frame.}

\item{response}{Character vector of response variables.}

\item{factor}{Character string for the factor variable.}

\item{method}{The statistical test to perform.
Available options are:
\itemize{
\item \code{"aov"} or \code{"anova"}: Analysis of Variance (ANOVA). TukeyHSD as default posthoc test (pairwise t.test with an adjustment method).
\item \code{"kw"} or \code{"kruskal"} or \code{"kruskal-wallis"}: Kruskal-Wallis test. Dunn's test as default posthoc test.
\item \code{"t.test"} or \code{"student"} or \code{"t"}: Student's t-test.
\item \code{"wilcox"} or \code{"wilcox.test"} or \code{"wilcoxon"} or \code{"mann-whitney"}: Wilcoxon test.
}}

\item{adjust}{The p-value adjustment method to apply in post-hoc tests.
Available options are \code{"holm"}, \code{"hochberg"}, \code{"bonferroni"}, \code{"bh"}, \code{"by"}, \code{"fdr"}, \code{"hommel"} (for aov), \code{"sidak"} (for kw), \code{"hs"} (for kw), and \code{"none"}. Default is \code{"none"}.}

\item{var.method}{Named character vector specifying the statistical test to use for each response variable.
The names must match exactly the variable names provided in \code{response},
and the values must be valid options accepted for the \code{method} argument.}

\item{var.adjust}{Named character vector specifying the p-value adjustment method to use for each response variable.
The names must match exactly the variable names provided in \code{response},
and the values must be valid options accepted for the \code{adjust} argument.}

\item{flip}{Logical. If \code{TRUE}, the axes are inverted: the \code{factor} variable is plotted on the y-axis, and the \code{response} variables are plotted on the x-axis. Default is \code{FALSE}.}

\item{filter.na}{Logical. If \code{TRUE}, rows with \code{NA} values in the current response variable are removed before analysis. Default is \code{FALSE}.}

\item{group.order}{Optional character vector specifying the order of the \code{x}-axis categories in the plot. Values must exactly match the factor levels in \code{x}.}

\item{print.test}{Logical. If \code{TRUE}, prints the test summary results to the console. Default is \code{FALSE}.}

\item{export.test}{Logical. If \code{TRUE}, exports statistical test details (test table, post-hoc, CLD) to a PDF report. Default is \code{FALSE}.}

\item{show.test}{Logical. If \code{TRUE}, the statistical test name and p-value are displayed in the top-left corner. Default is \code{FALSE}.}

\item{show.ph}{Logical. If \code{TRUE}, the post-hoc test name and p-value are displayed in the top-left corner. Default is \code{FALSE}.}

\item{show.letters}{Logical. If \code{TRUE}, significance letters for all groups are displayed (only for ANOVA and Kruskal-Wallis). Default is \code{FALSE}.}

\item{show.brackets}{Logical. If \code{TRUE} when \code{show.letters} is \code{TRUE}, a bracket is displayed for adjacent groups sharing the same letter. Default is \code{FALSE}.}

\item{plot.type}{Character string specifying the type of plot to produce. Either \code{"boxplot"} for box-and-whisker plots or \code{"meanplot"} for plots with group means and error bars. Default is \code{"boxplot"}.}

\item{fill}{Optional character. Specifies which plot element is filled with colors based on the factor variable. Default is \code{FALSE}.
\itemize{
\item With \code{plot.type = "boxplot"}:
\itemize{
\item \code{"box"}: fills the boxes according to the factor levels.
\item \code{"point"}: fills the points according to the factor levels.
\item \code{"both"}: fills both boxes and points independently.
}
\item With \code{plot.type = "meanplot"}:
\itemize{
\item \code{"point"}: fills the points according to the factor levels.
}
\item If \code{FALSE}, no elements are colored by factor.
}}

\item{fill.box}{Optional. Depending on the \code{fill} argument, is either a single color (e.g., \code{"white"}) applied to all boxes, a character vector of colors (length matching the number of factor levels), or the name of a ColorBrewer palette to fill the boxes. Default is \code{"white"}.}

\item{box.alpha}{Optional numeric between 0 and 1. Specifies the transparency (alpha) of the box fill when \code{plot.type = "boxplot"}. Default is \code{1} (fully opaque).}

\item{fill.point}{Optional. Depending on the \code{fill} argument, is either a single color (e.g., \code{"black"}) applied to all points, a character vector of colors (length matching the number of factor levels), or the name of a ColorBrewer palette to fill the points. Default is \code{"white"}.}

\item{point.alpha}{Optional numeric between 0 and 1. Specifies the transparency (alpha) of the points. Default is \code{1} (fully opaque).}

\item{fill.mean}{Optional. A single color used to fill all mean points when \code{plot.type = "meanplot"}. Default is \code{"black"}.}

\item{mean.alpha}{Optional numeric between 0 and 1. Specifies the transparency (alpha) of the mean points when \code{plot.type = "meanplot"}. Default is \code{1} (fully opaque).}

\item{log}{Logical. If \code{TRUE}, y-axis breaks and limits are adjusted to properly accommodate data values that may be negative or positive as a result of a logarithmic transformation. Default is \code{FALSE}.}

\item{group.label}{Optional character vector specifying the labels to display on the x-axis.}

\item{show.legend}{Logical. If \code{TRUE}, the plot legend is displayed. Default is \code{FALSE}.}

\item{point.shape}{Optional numeric. Specifies the shape of the points in the plot. Default is \code{21}.}

\item{mean.shape}{Optional numeric. Specifies the shape of the mean points in the plot. Default is \code{21}.}

\item{point.size}{Optional numeric. Specifies the size of the points in the plot. Default is \code{2.5}.}

\item{mean.size}{Optional numeric. Specifies the size of the mean points in the plot. Default is \code{2.5}.}

\item{jitter.width}{Optional numeric. Specifies the amount of horizontal jitter applied to points. Default is \code{0.2}.}

\item{error.width}{Optional numeric. Specifies the width of the error bars when \code{plot.type = "meanplot"}. Default is \code{0.2}.}

\item{error.alpha}{Optional numeric between 0 and 1. Specifies the transparency (alpha) of the error bars when \code{plot.type = "meanplot"}. Default is \code{1} (fully opaque).}

\item{axis.title.x}{Optional character string to rename the x-axis title. If not provided, the default x variable name is used.}

\item{axis.title.y}{Optional character string to rename the y-axis title. If not provided, the default y variable name is used.}

\item{axis.breaks.size}{Optional numeric. Specifies the size of all axis breaks text. Default is \code{12}.}

\item{axis.title.size}{Optional numeric. Specifies the size of the axis title text. Default is \code{12}.}

\item{axis.title.face}{Optional character. Specifies the font face (e.g., \code{"plain"}, \code{"bold"}, \code{"italic"}) for both axis titles. Default is \code{"plain"}.}

\item{label.angle}{Optional numeric. Angle of the axis tick labels. Default is \code{0}.}

\item{label.face}{Optional character. Font face for the axis tick labels. Default is \code{"plain"}.}

\item{letters.face}{Optional character. Specifies the font face for all significance letters. Default is \code{"plain"}.}

\item{letters.size}{Optional numeric. Specifies the size of all significance letters. Default is \code{5}.}

\item{text.family}{Optional character. Specifies the font family for all text elements in the plot. Default is \code{"sans"}.}

\item{theme.style}{Character. Specifies the ggplot2 theme style preset to apply to the plot.
Options include \code{"classic"}, \code{"bw"}, \code{"minimal"}, \code{"light"}, \code{"dark"}, \code{"gray"}, and \code{"void"}. Default is \code{"classic"}.}

\item{padding}{Optional numeric. Proportion of extra space added to the top of the y-axis to avoid clipping letters/brackets. Default is \code{0.2}.}

\item{grid}{Optional logical. If \code{TRUE}, arranges all response variable plots into a combined grid layout. Default is \code{FALSE}.}

\item{grid.axis}{Optional logical. If \code{TRUE} and \code{grid = TRUE}, individual plot axes are hidden and shared x and y axes are displayed for the entire grid. Default is \code{FALSE}.}

\item{ncol}{Integer. Number of columns in the combined grid plot.}

\item{nrow}{Integer. Number of rows in the combined grid plot.}

\item{grid.axis.x}{Optional character string to name the shared x-axis title. Default is \code{factor}.}

\item{grid.axis.y}{Optional character string to name the shared y-axis title. Default is \code{"Concentration"}.}

\item{x.title.shift}{Optional numeric. Horizontal shift applied to the shared x-axis label in grid layouts. Default is \code{0.02}.}

\item{var.size}{Optional numeric. Size of the labels displaying the name of each individual plot in the combined grid. Default is \code{18}.}

\item{var.face}{Optional character. Specifies the font face of the labels displaying the name of each individual plot in the combined grid. Default is \code{"bold"}.}

\item{save.plot}{Optional logical. If \code{TRUE}, saves each individual plot as a png file in the working directory. Default is \code{FALSE}.}

\item{by.var}{Optional logical. Used only if \code{save.plot = TRUE}. If \code{TRUE}, saves each plot individually in separate folders named after each response variable. Default is \code{FALSE}.}

\item{plot.height}{Optional numeric. Height of the saved plot image in inches when \code{save.plot = TRUE}. Default is \code{5}.}

\item{plot.width}{Optional numeric. Width of the saved plot image in inches when \code{save.plot = TRUE}. Default is \code{5}.}

\item{plot.name}{Optional character. Name of the saved plot file. Defaults to \code{"plot_{var}.png"}, where \code{{var}} is replaced by the response variable name when saving multiple plots.}

\item{save.grid}{Optional logical. If \code{TRUE}, saves the combined grid as a JPEG file in the working directory. Default is \code{FALSE}.}

\item{grid.name}{Optional character. Name of the saved combined grid plot file. Default is \code{"grid.png"}.}

\item{grid.height}{Optional numeric. Height of the saved combined grid plot image in inches when \code{save.grid = TRUE}. Default is \code{8}.}

\item{grid.width}{Optional numeric. Width of the saved combined grid plot image in inches when \code{save.grid = TRUE}. Default is \code{7}.}
}
\value{
\itemize{
\item If \code{grid = TRUE}: returns a single \code{ggplot} object representing the combined grid of all response variable plots.
\item If \code{grid = FALSE}: each plot (\code{p}) is printed to the current graphics device as it is built.
In addition, the function invisibly returns a list containing:
\itemize{
\item \code{plots}: the individual \code{ggplot} objects (\code{p}) for each response variable.
\item \code{plots1}: the alternative versions of each plot (\code{p1}) used for grid construction.
}
\item If \code{export.test = TRUE}: in addition to plots, a PDF file (\code{Stats_Report.pdf}) is created in the \code{"elements"} folder containing tables of statistical test results, post-hoc results, and compact letter displays (CLD).
\item If \code{save.plot = TRUE} or \code{save.grid = TRUE}: plots or the grid are saved to file as PNG images in the specified location.
}
}
\description{
This function creates boxplots or mean plots for one or more response variables,
performs the specified statistical tests, and optionally adds post-hoc results,
compact letter displays (CLD), and annotations. It can also arrange plots into a grid,
save plots to files, and export statistical summaries to a PDF.
}
\examples{
# Example dataset
df <- data.frame(
  group = rep(c("A", "B", "C"), each = 10),
  value1 = c(rnorm(10, 5), rnorm(10, 6), rnorm(10, 7)),
  value2 = c(rnorm(10, 3), rnorm(10, 4), rnorm(10, 5))
)

# Basic boxplot with ANOVA and significance letters
get.plot(
  data = df,
  response = "value1",
  factor = "group",
  method = "aov",
  group.order = c("A", "B", "C"),
  show.letters = TRUE,
  plot.type = "boxplot"
)

# Mean plot with Kruskal-Wallis test and error bars
get.plot(
  data = df,
  response = "value2",
  factor = "group",
  method = "kw",
  group.order = c("A", "B", "C"),
  plot.type = "meanplot",
  fill = "point",
  show.test = TRUE
)

# Multiple response variables arranged in a grid
get.plot(
  data = df,
  response = c("value1", "value2"),
  factor = "group",
  method = "aov",
  group.order = c("A", "B", "C"),
  grid = TRUE,
  nrow = 1,
  ncol = 2,
  grid.axis = TRUE,
  grid.axis.x = "Experimental group",
  grid.axis.y = "Measured value"
)

}
